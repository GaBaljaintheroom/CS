### ALU와 제어장치

**ALU**

- 레지스터를 통해 피연산자를 받아들이고, 제어장치로부터 수행할 연산을 알려주는 제어 신호를 받아드림

**플래그**

| 플래그 종류  | 의미  | 사용 예시 |
| --- | --- | --- |
| 부호 플래그  | 연산한 결과의 부호를 나타낸다. | 부호 플래그가 1일 경우 계산 결과는 음수, 0일 경우 계산 결과는 양수를 의미한다 |
| 제로 플래그  | 연산 결과가 0인지 여부를 나타낸다,. | 제로 플래그가 1일 경우 연산 결과는 0, 0일 경우 연산 결과는 0이 아님을 의미한다 |
| 오버플로우 플래그  | 오버플로우가 발생했는지를 나타낸다. | 오버플로우 플래그가 1일 경우 오버플로우가 발생했음을 의미하고, 0일 경우 발생하지 않았음을 의미한다. |
| 캐리 플래그 | 연산 결과 올림수나 발림수가 발생했는지를 나타낸다. | 캐리 플래그가 1일 경우 올림수나 발림수가 발생했음을 의미하고, 0의 경우 발생하지 않았음을 의미한다. |
| 인터럽트 플래그 | 인터럽트가 가능한지를 나타낸디.  | 인터럽트 플래그가 1일 경우 인터럽트가 가능함을 의미하고, 0일 경우 인터럽트가 불가능함을 의미한다. |
| 슈퍼바이저 플래그 | 커널 모드로 실행 중인지, 사용자 모드로 실행 중인지를 나타낸다.  | 슈퍼바이저 플래그가 1일 경우 커널 모드로 실행중임을 의미하고, 0일 경우 사용자 모드로 실행중임을 의미한다. |

**제어장치**

- 제어 신호를 내보내고 명령어를 해석하는 부품

역할

1. 제어장치는 클럭 신호를 받아들인다.
    - 클럭 : 컴퓨터의 모든 부품을 일사불란하게 움직일 수 있게 하는 시간 단위
        - 클럭이라는 박자에 맞춰 작동할 뿐 컴퓨터의 모든 부품이 한 클럭마다 작동하는 것은 아님
2. 제어 장치는 ‘해석해야 할 명령어’를 받아들임
    - CPU가 해석해야 할 명령어는 명령어 레지스터에 저장
    - 제어장치는 명령어 레지스터로부터 해석할 명령어를 받아들이고 해석하 뒤, 제어 신호룰 발생시켜 컴퓨터 부품들에 수행해야 할 내용을 알려줌
3. 제어장치는 플래그 레지스터 속 플래그 값을 받아들임
4. 제어장치는 시스템 버스, 그중에서 제어 버스로 전달된 제어 신호를 받아들임
    - 메모리에 전달하는 제어 신호와 입출력장치에 전달하는 제어 신호

### 레지스터

**프로그램 카운터**

- 메모리에서 가져올 명령어의 주소를 저장하는 레지스터
- 명령어 포인트라고 부르는  CPU도 있음

**명령어 레지스터**

- 방금 메모리에서 읽어 들인 명령어를 저장하는 레지스터

**메모리 주소 레지스터**

- 메모리의 주소를 저장하는 레지스터

**메모리 버퍼 레지스터**

- 메모리와 주고받을 값(데이터와 명령어)을 저장하는 레지스터

**범용 레지스터**

- 다양하고 일반적인 상황에서 자유롭게 사용할 수 있는 레지스터

**플래그 레지스터**

- 연산 결과 또는 CPU 상태에 대한 부가적인 정보를 저장하는 레지스터

**특정 레지스터를 이용한 주소 지정 방식**

- **스택 주소 지정 방식**
    - 스택과 스택 포인터를 이용한 주소 지정 방식
    - 스택 포인터 : 스택의 꼭대기를 가리키는 레지스터
- **변위 주소 지정 방식**
    - 오퍼랜드 필드의 값과 특정 레지스터의 값을  더하여 유효 주소를 얻어내는 주소 지정 방식
    - **상대 주소 지정 방식**
        - 오퍼랜드와 프로그램 카운터의 값을 더하여 유효 주소를 얻는 방식
    - **베이스 레지스터 주소 지정 방식**
        - 오퍼랜드와 베이스 레지서트이 값을 더하여 유효 주소를 얻는 방식
        - 베이스 레지스터 : ‘기준 주소’
        - 오퍼랜드 : ‘기준 주소로부터 떨어진 거리’

### 명령어 사이클과 인터럽트

**명령어 사이클**


- 프로그램 속 각각의 명령어들이 일정하게 반복되는 주기
- 인출 사이클
    - 메모리에 있는 명령어를 CPU로 가지고 오는 단계
- 실행 사이클
    - CPU로 가져온 명령어를 실행하는 사이클
- 간접 사이클
    - 명령어를 실행하기 위해 메모리 접근이 필요한 경우

**인터럽트**

- CPU의 정상적인 작업을 방해하는 신호
- **동기 인터럽트**
    - CPU에 의해 발생하는 인터럽트
    - CPU가 실행하는 프로그래밍상의 오류와 같은 예외적인 상황에 마주쳤을 때 발생하는 인터럽트
    - 예외 라고도 함
- **비동기 인터럽트(=하드웨어 인터럽트)**
    - 입출력장치에 의해 발생하는 인터럽트
    - 키보드, 마우스, 프린트

**하드웨어 인터럽트 처리 순서**

1. 입출력장치는 CPU에 인터럽트 요청 신호를 보냄
2. CPU는 실행 사이클이 끝나고 명령어를 인출하기 전 항상 인터럽트 여부를 확인함
3. CPU는 인터럽트 요청을 확인하고 인터럽트 플래그를 통해 현재 인터럽트를 받아들일 수 있는지 여부를 확인
    - 플래그 불가능 : CPU는 인터럽트 요청이 오더라도 해당 요청을 무시
        - 막을 수 있는 인터럽트
        - 막을 수 없는 인터럽트 (정전, 하드웨어 고장)
    - 플래그 가능 : CPU는 인터럽트 요청 신호를 받아들이고 인터럽트를 처리
4. 인터럽트를 받아들일 수 있다면 CPU는 지금까지의 작업을 백업
5. CPU는 인터럽트 백터를 참조하여 인터럽트 서비스 루틴을 실행함
    - **인터럽트 서비스 루틴** : 인터럽트를 처리하기 위한 프로그램
        - 해당 인터럽트를 어떻게 처리하고 작동해야 할지에 대한 정보로 이루어진 프로그램
    - **인터럽트 백터** : 인터럽트 서비스 루틴을 식별하기 위한 정보
        - 인터럽트 서비스 루틴의 시작 주소를 알 수 있기 때문에 CPU는 인터럽트 벡터를 통해 특정 인터럽트 서비스 루틴을 처음부터 실행할 수 있음
6. 인터럽트 서비스 루틴 실행이 끝나면 4에서 백업해 둔 작업을 복구하여 실행을 재개합니다.